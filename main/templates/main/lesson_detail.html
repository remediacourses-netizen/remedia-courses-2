{% extends 'base.html' %}
{% load filename_filters %}
{% block content %}
<h2 class="lesson-header">{{ lesson.title }}</h2>

<div class="lesson-card">
    <!-- –í–∏–¥–µ–æ -->
    <div class="lesson-video">
        {% if lesson.video_url %}
        <iframe src="{{ lesson.get_embed_url }}" frameborder="0" allowfullscreen></iframe>
        {% else %}
        <p>–í–∏–¥–µ–æ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ.</p>
        {% endif %}
    </div>


    <!-- –ó–∞–¥–∞–Ω–∏–µ -->
    <div class="lesson-task">
        <h3>–ó–∞–¥–∞–Ω–∏–µ –∫ —É—Ä–æ–∫—É:</h3>

        {% if lesson.task_files.all %}
        <ul>
            {% for task_file in lesson.task_files.all %}
            <li><a href="{{ task_file.file.url }}" download>üìé {{ task_file.file.name|basename }}</a></li>
            {% endfor %}
        </ul>
        {% else %}
        <p>–ó–∞–¥–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ.</p>
        {% endif %}

        {% if lesson.task_url %}
        <div class="practical-task">
            <span class="label">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</span>
            <span class="divider">|</span>
            <a href="{{ lesson.task_url }}" target="_blank" class="task-link">–ü–µ—Ä–µ–π—Ç–∏</a>
        </div>
        {% endif %}
    </div>



    <!-- –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
    <div class="homework-form">
        <form action="{% url 'submit_homework' lesson.id %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <label for="answer">–û—Ç–≤–µ—Ç:</label>
            <textarea name="answer" id="answer" rows="4" required></textarea>

            <label for="file">–§–∞–π–ª (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
            <input type="file" name="file" id="file">
            <small>–§–æ—Ä–º–∞—Ç—ã: PDF, DOCX, ZIP, PNG, JPG</small>

            <button type="submit" class="submit-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–º–∞—à–∫—É</button>
        </form>

        {% if messages %}
        <ul class="messages">
            {% for message in messages %}
            <li class="{{ message.tags }}">{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>
</div>

<a class="back-link" href="{% url 'lesson_list' lesson.module.id %}">‚Üê –ù–∞–∑–∞–¥ –∫ —É—Ä–æ–∫–∞–º</a>

{% endblock %}